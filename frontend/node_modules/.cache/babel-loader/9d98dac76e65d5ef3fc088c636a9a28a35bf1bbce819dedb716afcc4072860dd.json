{"ast":null,"code":"var _jsxFileName = \"D:\\\\REACT\\\\collaborative-drawing-app\\\\frontend\\\\src\\\\components\\\\Canvas.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState, useContext } from 'react';\nimport { WebSocketContext } from '../context/WebSocketContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Canvas = () => {\n  _s();\n  const canvasRef = useRef(null);\n  const [drawing, setDrawing] = useState(false);\n  const [lastPosition, setLastPosition] = useState({\n    x: null,\n    y: null\n  });\n  const context = useContext(WebSocketContext);\n  const wsRef = context === null || context === void 0 ? void 0 : context.wsRef;\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas || !wsRef || !wsRef.current) return;\n    const ctx = canvas.getContext('2d');\n    canvas.width = window.innerWidth * 0.8;\n    canvas.height = window.innerHeight * 0.6;\n    ctx.lineCap = 'round';\n    function drawStroke(stroke) {\n      ctx.beginPath();\n      ctx.moveTo(stroke.fromX, stroke.fromY);\n      ctx.lineTo(stroke.toX, stroke.toY);\n      ctx.strokeStyle = stroke.color;\n      ctx.lineWidth = stroke.thickness;\n      ctx.stroke();\n    }\n    const receive = event => {\n      const msg = JSON.parse(event.data);\n      if (msg.type === \"init\" && Array.isArray(msg.history)) {\n        msg.history.forEach(drawStroke);\n      } else if (msg.type === \"draw\") {\n        drawStroke(msg);\n      }\n    };\n    const socket = wsRef.current;\n    socket.addEventListener('message', receive);\n    return () => {\n      socket.removeEventListener('message', receive);\n    };\n  }, [wsRef]);\n  const start = e => {\n    const {\n      offsetX,\n      offsetY\n    } = e.nativeEvent;\n    const ctx = canvasRef.current.getContext('2d');\n    ctx.beginPath();\n    ctx.moveTo(offsetX, offsetY);\n    setDrawing(true);\n    setLastPosition({\n      x: offsetX,\n      y: offsetY\n    });\n  };\n  const move = e => {\n    if (!drawing) return;\n    const {\n      offsetX,\n      offsetY\n    } = e.nativeEvent;\n    const ctx = canvasRef.current.getContext('2d');\n    ctx.lineTo(offsetX, offsetY);\n    ctx.stroke();\n    if (wsRef && wsRef.current && wsRef.current.readyState === 1 && lastPosition.x !== null) {\n      wsRef.current.send(JSON.stringify({\n        type: 'draw',\n        fromX: lastPosition.x,\n        fromY: lastPosition.y,\n        toX: offsetX,\n        toY: offsetY,\n        color: ctx.strokeStyle,\n        thickness: ctx.lineWidth\n      }));\n    }\n    setLastPosition({\n      x: offsetX,\n      y: offsetY\n    });\n  };\n  const stop = () => {\n    setDrawing(false);\n    setLastPosition({\n      x: null,\n      y: null\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"canvas\", {\n    ref: canvasRef,\n    style: {\n      border: '1px solid #999',\n      background: '#fff',\n      borderRadius: '8px'\n    },\n    onMouseDown: start,\n    onMouseMove: move,\n    onMouseUp: stop,\n    onMouseLeave: stop\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, this);\n};\n_s(Canvas, \"fB1pZaidfmuhxk07Y9F8QGujdRY=\");\n_c = Canvas;\nexport default Canvas;\nvar _c;\n$RefreshReg$(_c, \"Canvas\");","map":{"version":3,"names":["React","useRef","useEffect","useState","useContext","WebSocketContext","jsxDEV","_jsxDEV","Canvas","_s","canvasRef","drawing","setDrawing","lastPosition","setLastPosition","x","y","context","wsRef","canvas","current","ctx","getContext","width","window","innerWidth","height","innerHeight","lineCap","drawStroke","stroke","beginPath","moveTo","fromX","fromY","lineTo","toX","toY","strokeStyle","color","lineWidth","thickness","receive","event","msg","JSON","parse","data","type","Array","isArray","history","forEach","socket","addEventListener","removeEventListener","start","e","offsetX","offsetY","nativeEvent","move","readyState","send","stringify","stop","ref","style","border","background","borderRadius","onMouseDown","onMouseMove","onMouseUp","onMouseLeave","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/REACT/collaborative-drawing-app/frontend/src/components/Canvas.js"],"sourcesContent":["import React, { useRef, useEffect, useState, useContext } from 'react';\r\nimport { WebSocketContext } from '../context/WebSocketContext';\r\n\r\nconst Canvas = () => {\r\n  const canvasRef = useRef(null);\r\n  const [drawing, setDrawing] = useState(false);\r\n  const [lastPosition, setLastPosition] = useState({ x: null, y: null });\r\n  const context = useContext(WebSocketContext);\r\n  const wsRef = context?.wsRef;\r\n\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas || !wsRef || !wsRef.current) return;\r\n    const ctx = canvas.getContext('2d');\r\n    canvas.width = window.innerWidth * 0.8;\r\n    canvas.height = window.innerHeight * 0.6;\r\n    ctx.lineCap = 'round';\r\n\r\n    function drawStroke(stroke) {\r\n      ctx.beginPath();\r\n      ctx.moveTo(stroke.fromX, stroke.fromY);\r\n      ctx.lineTo(stroke.toX, stroke.toY);\r\n      ctx.strokeStyle = stroke.color;\r\n      ctx.lineWidth = stroke.thickness;\r\n      ctx.stroke();\r\n    }\r\n\r\n    const receive = event => {\r\n      const msg = JSON.parse(event.data);\r\n      if (msg.type === \"init\" && Array.isArray(msg.history)) {\r\n        msg.history.forEach(drawStroke);\r\n      } else if (msg.type === \"draw\") {\r\n        drawStroke(msg);\r\n      }\r\n    };\r\n\r\n    const socket = wsRef.current;\r\n    socket.addEventListener('message', receive);\r\n    return () => {\r\n      socket.removeEventListener('message', receive);\r\n    };\r\n  }, [wsRef]);\r\n\r\n  const start = e => {\r\n    const { offsetX, offsetY } = e.nativeEvent;\r\n    const ctx = canvasRef.current.getContext('2d');\r\n    ctx.beginPath();\r\n    ctx.moveTo(offsetX, offsetY);\r\n    setDrawing(true);\r\n    setLastPosition({ x: offsetX, y: offsetY });\r\n  };\r\n\r\n  const move = e => {\r\n    if (!drawing) return;\r\n    const { offsetX, offsetY } = e.nativeEvent;\r\n    const ctx = canvasRef.current.getContext('2d');\r\n    ctx.lineTo(offsetX, offsetY);\r\n    ctx.stroke();\r\n    if (wsRef && wsRef.current && wsRef.current.readyState === 1 && lastPosition.x !== null) {\r\n      wsRef.current.send(JSON.stringify({\r\n        type: 'draw',\r\n        fromX: lastPosition.x,\r\n        fromY: lastPosition.y,\r\n        toX: offsetX,\r\n        toY: offsetY,\r\n        color: ctx.strokeStyle,\r\n        thickness: ctx.lineWidth\r\n      }));\r\n    }\r\n    setLastPosition({ x: offsetX, y: offsetY });\r\n  };\r\n\r\n  const stop = () => {\r\n    setDrawing(false);\r\n    setLastPosition({ x: null, y: null });\r\n  };\r\n\r\n  return (\r\n    <canvas\r\n      ref={canvasRef}\r\n      style={{\r\n        border: '1px solid #999',\r\n        background: '#fff',\r\n        borderRadius: '8px'\r\n      }}\r\n      onMouseDown={start}\r\n      onMouseMove={move}\r\n      onMouseUp={stop}\r\n      onMouseLeave={stop}\r\n    />\r\n  );\r\n};\r\n\r\nexport default Canvas;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}