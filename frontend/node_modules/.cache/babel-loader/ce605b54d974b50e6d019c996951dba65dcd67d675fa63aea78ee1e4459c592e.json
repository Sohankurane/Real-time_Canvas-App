{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useRef, useContext } from 'react';\nimport { WebSocketContext } from '../../context/WebSocketContext';\nimport { WS_EVENTS } from '../../constants';\n\n/**\r\n * Custom hook for ChatBox component\r\n * Handles all business logic and state management\r\n */\nexport const useChatBox = (roomId, username) => {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [isOpen, setIsOpen] = useState(false);\n  const messagesEndRef = useRef(null);\n  const {\n    lastMessage,\n    sendMessage\n  } = useContext(WebSocketContext);\n\n  // Auto-scroll to bottom when new messages arrive\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // Listen to WebSocket messages for chat events\n  useEffect(() => {\n    if (!lastMessage) return;\n    try {\n      const msg = JSON.parse(lastMessage);\n      if (msg.type === WS_EVENTS.CHAT) {\n        setMessages(prev => [...prev, {\n          username: msg.username,\n          message: msg.message,\n          timestamp: msg.timestamp || new Date().toISOString()\n        }]);\n      }\n    } catch (error) {\n      console.error('Error parsing chat message:', error);\n    }\n  }, [lastMessage]);\n  const toggleChat = () => {\n    setIsOpen(prev => !prev);\n  };\n  const handleSendMessage = e => {\n    e.preventDefault();\n    if (!newMessage.trim() || !sendMessage) return;\n    const chatMessage = {\n      type: WS_EVENTS.CHAT,\n      username,\n      message: newMessage.trim(),\n      timestamp: new Date().toISOString()\n    };\n    sendMessage(JSON.stringify(chatMessage));\n    setNewMessage('');\n  };\n  return {\n    messages,\n    newMessage,\n    setNewMessage,\n    isOpen,\n    toggleChat,\n    handleSendMessage,\n    messagesEndRef\n  };\n};\n_s(useChatBox, \"CWglvPr+32ReepBig8cQoKLrwPc=\");","map":{"version":3,"names":["useState","useEffect","useRef","useContext","WebSocketContext","WS_EVENTS","useChatBox","roomId","username","_s","messages","setMessages","newMessage","setNewMessage","isOpen","setIsOpen","messagesEndRef","lastMessage","sendMessage","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","msg","JSON","parse","type","CHAT","prev","message","timestamp","Date","toISOString","error","console","toggleChat","handleSendMessage","e","preventDefault","trim","chatMessage","stringify"],"sources":["D:/REACT/collaborative-drawing-app/frontend/src/components/ChatBox/ChatBox.hook.js"],"sourcesContent":["import { useState, useEffect, useRef, useContext } from 'react';\r\nimport { WebSocketContext } from '../../context/WebSocketContext';\r\nimport { WS_EVENTS } from '../../constants';\r\n\r\n/**\r\n * Custom hook for ChatBox component\r\n * Handles all business logic and state management\r\n */\r\nexport const useChatBox = (roomId, username) => {\r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const messagesEndRef = useRef(null);\r\n  const { lastMessage, sendMessage } = useContext(WebSocketContext);\r\n\r\n  // Auto-scroll to bottom when new messages arrive\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  // Listen to WebSocket messages for chat events\r\n  useEffect(() => {\r\n    if (!lastMessage) return;\r\n\r\n    try {\r\n      const msg = JSON.parse(lastMessage);\r\n      \r\n      if (msg.type === WS_EVENTS.CHAT) {\r\n        setMessages((prev) => [\r\n          ...prev,\r\n          {\r\n            username: msg.username,\r\n            message: msg.message,\r\n            timestamp: msg.timestamp || new Date().toISOString()\r\n          }\r\n        ]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error parsing chat message:', error);\r\n    }\r\n  }, [lastMessage]);\r\n\r\n  const toggleChat = () => {\r\n    setIsOpen((prev) => !prev);\r\n  };\r\n\r\n  const handleSendMessage = (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!newMessage.trim() || !sendMessage) return;\r\n\r\n    const chatMessage = {\r\n      type: WS_EVENTS.CHAT,\r\n      username,\r\n      message: newMessage.trim(),\r\n      timestamp: new Date().toISOString()\r\n    };\r\n\r\n    sendMessage(JSON.stringify(chatMessage));\r\n    setNewMessage('');\r\n  };\r\n\r\n  return {\r\n    messages,\r\n    newMessage,\r\n    setNewMessage,\r\n    isOpen,\r\n    toggleChat,\r\n    handleSendMessage,\r\n    messagesEndRef\r\n  };\r\n};\r\n"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,EAAEC,MAAM,EAAEC,UAAU,QAAQ,OAAO;AAC/D,SAASC,gBAAgB,QAAQ,gCAAgC;AACjE,SAASC,SAAS,QAAQ,iBAAiB;;AAE3C;AACA;AACA;AACA;AACA,OAAO,MAAMC,UAAU,GAAGA,CAACC,MAAM,EAAEC,QAAQ,KAAK;EAAAC,EAAA;EAC9C,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGX,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACY,UAAU,EAAEC,aAAa,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;EAChD,MAAM,CAACc,MAAM,EAAEC,SAAS,CAAC,GAAGf,QAAQ,CAAC,KAAK,CAAC;EAC3C,MAAMgB,cAAc,GAAGd,MAAM,CAAC,IAAI,CAAC;EACnC,MAAM;IAAEe,WAAW;IAAEC;EAAY,CAAC,GAAGf,UAAU,CAACC,gBAAgB,CAAC;;EAEjE;EACA,MAAMe,cAAc,GAAGA,CAAA,KAAM;IAAA,IAAAC,qBAAA;IAC3B,CAAAA,qBAAA,GAAAJ,cAAc,CAACK,OAAO,cAAAD,qBAAA,uBAAtBA,qBAAA,CAAwBE,cAAc,CAAC;MAAEC,QAAQ,EAAE;IAAS,CAAC,CAAC;EAChE,CAAC;EAEDtB,SAAS,CAAC,MAAM;IACdkB,cAAc,CAAC,CAAC;EAClB,CAAC,EAAE,CAACT,QAAQ,CAAC,CAAC;;EAEd;EACAT,SAAS,CAAC,MAAM;IACd,IAAI,CAACgB,WAAW,EAAE;IAElB,IAAI;MACF,MAAMO,GAAG,GAAGC,IAAI,CAACC,KAAK,CAACT,WAAW,CAAC;MAEnC,IAAIO,GAAG,CAACG,IAAI,KAAKtB,SAAS,CAACuB,IAAI,EAAE;QAC/BjB,WAAW,CAAEkB,IAAI,IAAK,CACpB,GAAGA,IAAI,EACP;UACErB,QAAQ,EAAEgB,GAAG,CAAChB,QAAQ;UACtBsB,OAAO,EAAEN,GAAG,CAACM,OAAO;UACpBC,SAAS,EAAEP,GAAG,CAACO,SAAS,IAAI,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;QACrD,CAAC,CACF,CAAC;MACJ;IACF,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;IACrD;EACF,CAAC,EAAE,CAACjB,WAAW,CAAC,CAAC;EAEjB,MAAMmB,UAAU,GAAGA,CAAA,KAAM;IACvBrB,SAAS,CAAEc,IAAI,IAAK,CAACA,IAAI,CAAC;EAC5B,CAAC;EAED,MAAMQ,iBAAiB,GAAIC,CAAC,IAAK;IAC/BA,CAAC,CAACC,cAAc,CAAC,CAAC;IAElB,IAAI,CAAC3B,UAAU,CAAC4B,IAAI,CAAC,CAAC,IAAI,CAACtB,WAAW,EAAE;IAExC,MAAMuB,WAAW,GAAG;MAClBd,IAAI,EAAEtB,SAAS,CAACuB,IAAI;MACpBpB,QAAQ;MACRsB,OAAO,EAAElB,UAAU,CAAC4B,IAAI,CAAC,CAAC;MAC1BT,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;IACpC,CAAC;IAEDf,WAAW,CAACO,IAAI,CAACiB,SAAS,CAACD,WAAW,CAAC,CAAC;IACxC5B,aAAa,CAAC,EAAE,CAAC;EACnB,CAAC;EAED,OAAO;IACLH,QAAQ;IACRE,UAAU;IACVC,aAAa;IACbC,MAAM;IACNsB,UAAU;IACVC,iBAAiB;IACjBrB;EACF,CAAC;AACH,CAAC;AAACP,EAAA,CAnEWH,UAAU","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}