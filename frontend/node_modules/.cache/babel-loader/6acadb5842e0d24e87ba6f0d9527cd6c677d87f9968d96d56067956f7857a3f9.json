{"ast":null,"code":"import _objectSpread from\"D:/REACT/collaborative-drawing-app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useRef,useEffect,useState,useContext,useCallback,useMemo}from'react';import{WebSocketContext}from'../context/WebSocketContext';import'./Canvas.css';// --- Configuration Constants ---\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const COLORS=['#e53e3e','#3182ce','#38a169','#f6ad55','#2d3748','#555'];const THICKNESS=[2,4,6,8,12];const TOOLS=[{key:'brush',label:'Brush'},{key:'eraser',label:'Eraser'},{key:'rectangle',label:'Rectangle'},{key:'ellipse',label:'Ellipse'},{key:'text',label:'Text'},{key:'undo',label:'Undo'}];const CURSORS={brush:\"url(\\\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32'><circle cx='16' cy='16' r='8' fill='white' stroke='blue' stroke-width='3'/></svg>\\\") 16 16, crosshair\",eraser:\"url(\\\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32'><rect x='7' y='10' width='18' height='8' rx='4' fill='pink' stroke='gray' stroke-width='2'/></svg>\\\") 16 14, pointer\",rectangle:\"url(\\\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32'><rect x='8' y='8' width='16' height='10' stroke='red' fill='white' stroke-width='3'/></svg>\\\") 16 16, crosshair\",ellipse:\"url(\\\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32'><ellipse cx='16' cy='16' rx='8' ry='5' stroke='green' fill='white' stroke-width='3'/></svg>\\\") 16 16, crosshair\",text:\"url(\\\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32'><text x='4' y='22' font-size='18' font-family='Arial' fill='black'>T</text></svg>\\\") 6 22, text\",undo:\"crosshair\"};const CANVAS_W=1200;const CANVAS_H=700;// --- Utility Function: Debounce ---\nfunction debounce(fn){let ms=arguments.length>1&&arguments[1]!==undefined?arguments[1]:12;let timeout;return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}clearTimeout(timeout);timeout=setTimeout(()=>fn(...args),ms);};}// --- Main Canvas Component ---\nconst Canvas=_ref=>{let{user,roomId,adminUsername,onSwitchRoom}=_ref;// --- Local State and Context ---\nconst canvasRef=useRef(null);const[drawing,setDrawing]=useState(false);const[lastPosition,setLastPosition]=useState({x:null,y:null});const[color,setColor]=useState(COLORS[1]);const[thickness,setThickness]=useState(4);const[tool,setTool]=useState('brush');const[shapes,setShapes]=useState([]);const[shapeStart,setShapeStart]=useState(null);const[cursors,setCursors]=useState({});const[snapshots,setSnapshots]=useState([]);const[showSnapshots,setShowSnapshots]=useState(false);const[savingSnapshot,setSavingSnapshot]=useState(false);const{wsRef,wsStatus,sendMessage,getQueueStatus}=useContext(WebSocketContext);const username=user===null||user===void 0?void 0:user.username;// --- Helper: Clear cursors on room change & send a local event ---\nuseEffect(()=>{setCursors({});const canvas=canvasRef.current;if(!canvas||!(user!==null&&user!==void 0&&user.username)||!sendMessage)return;const rect=canvas.getBoundingClientRect();const x=Math.round(rect.width/2);const y=Math.round(rect.height/2);sendMessage({type:'cursor',x,y,userId:user.username,name:user.firstName||user.username,tool});},[roomId,user,sendMessage,tool]);// --- Safe wrapper for sending WebSocket messages ---\nconst safeSendWS=useCallback(obj=>{if(sendMessage){sendMessage(obj);}else{console.warn('sendMessage not available from context');}},[sendMessage]);// --- Canvas coordinates relative to element size ---\nconst getCanvasCoords=e=>{const rect=canvasRef.current.getBoundingClientRect();return{x:Math.round((e.clientX-rect.left)/rect.width*CANVAS_W),y:Math.round((e.clientY-rect.top)/rect.height*CANVAS_H)};};// --- Drawing logic for all supported shapes ---\nconst drawStroke=useCallback(stroke=>{var _canvasRef$current;const ctx=(_canvasRef$current=canvasRef.current)===null||_canvasRef$current===void 0?void 0:_canvasRef$current.getContext('2d');if(!ctx)return;if(['draw','brush','eraser'].includes(stroke.type)){ctx.beginPath();ctx.moveTo(stroke.fromX,stroke.fromY);ctx.lineTo(stroke.toX,stroke.toY);ctx.strokeStyle=stroke.color;ctx.lineWidth=stroke.thickness;ctx.stroke();}if(stroke.type==='rectangle'){ctx.strokeStyle=stroke.color;ctx.lineWidth=stroke.thickness;ctx.strokeRect(stroke.fromX,stroke.fromY,stroke.toX-stroke.fromX,stroke.toY-stroke.fromY);}if(stroke.type==='ellipse'){ctx.strokeStyle=stroke.color;ctx.lineWidth=stroke.thickness;ctx.beginPath();ctx.ellipse((stroke.fromX+stroke.toX)/2,(stroke.fromY+stroke.toY)/2,Math.abs((stroke.toX-stroke.fromX)/2),Math.abs((stroke.toY-stroke.fromY)/2),0,0,2*Math.PI);ctx.stroke();}if(stroke.type==='text'){ctx.fillStyle=stroke.color;ctx.font=\"\".concat(stroke.fontSize||20,\"px sans-serif\");ctx.fillText(stroke.value,stroke.x,stroke.y);}},[]);// --- Snapshot logic for exporting/loading canvas state ---\nconst exportCanvasStateJSON=()=>JSON.stringify(shapes);const loadCanvasFromSnapshot=useCallback(snapshotJSON=>{var _canvasRef$current2;const snap=JSON.parse(snapshotJSON);setShapes(snap);const ctx=(_canvasRef$current2=canvasRef.current)===null||_canvasRef$current2===void 0?void 0:_canvasRef$current2.getContext('2d');if(ctx){ctx.clearRect(0,0,CANVAS_W,CANVAS_H);snap.forEach(drawStroke);}},[drawStroke]);// --- Handlers for saving and restoring snapshots ---\nconst handleSaveSnapshot=()=>{if(savingSnapshot)return;setSavingSnapshot(true);safeSendWS({type:'save_snapshot',snapshot:exportCanvasStateJSON(),username});setTimeout(()=>setSavingSnapshot(false),1000);};const handleShowSnapshotHistory=()=>{safeSendWS({type:'get_snapshots'});setShowSnapshots(true);};const handleRestoreSnapshot=snapshotId=>{safeSendWS({type:'restore_snapshot',snapshot_id:snapshotId,username});};// --- Presence helpers and UI for active users ---\nconst getActiveUsers=()=>Object.entries(cursors).filter(_ref2=>{let[id]=_ref2;return id!==(user===null||user===void 0?void 0:user.username);}).map(_ref3=>{let[id,c]=_ref3;return{id,name:c.name,tool:c.tool,x:c.x,y:c.y};});const renderActiveUsersBar=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"canvas-usersbar\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"canvas-usersbar-title\",children:\"Active Participants:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"canvas-usersbar-user\",children:[(user===null||user===void 0?void 0:user.firstName)||(user===null||user===void 0?void 0:user.username),\" (You)\"]}),getActiveUsers().map(u=>/*#__PURE__*/_jsxs(\"span\",{className:\"canvas-usersbar-user\",children:[u.name,\" \",u.tool?/*#__PURE__*/_jsxs(\"span\",{style:{fontSize:13,color:'#3182ce'},children:[\"(\",u.tool,\")\"]}):null]},u.id))]});const renderUserClaims=()=>{return getActiveUsers().map(u=>u.x!=null&&u.y!=null?/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',left:u.x-24,top:u.y-24,pointerEvents:'none',zIndex:9,width:48,height:48,borderRadius:'50%',background:'rgba(226,38,77, 0.16)',border:'2px solid #e53e3e'}},u.id+\"-zone\"):null);};// --- Conflict detection for real-time coordination ---\nconst isConflict=(x,y)=>{return getActiveUsers().some(u=>u.x&&u.y&&Math.abs(u.x-x)<45&&Math.abs(u.y-y)<45);};// --- Effect: Setup websocket for drawing/undo/cursor/messages ---\nuseEffect(()=>{const canvas=canvasRef.current;if(!canvas||!wsRef||!wsRef.current)return;canvas.width=CANVAS_W;canvas.height=CANVAS_H;const ctx=canvas.getContext('2d');ctx.lineCap='round';// Websocket receive event for this canvas\nconst receive=event=>{const msg=JSON.parse(event.data);if(msg.type===\"init\"&&Array.isArray(msg.history)){msg.history.forEach(drawStroke);}else if(['draw','brush','eraser','rectangle','ellipse','text'].includes(msg.type)){drawStroke(msg);setShapes(shapes=>[...shapes,msg]);}else if(msg.type===\"undo\"){setShapes(shapes=>{const result=shapes.slice(0,-1);ctx.clearRect(0,0,CANVAS_W,CANVAS_H);result.forEach(drawStroke);return result;});}else if(msg.type===\"clear\"){setShapes([]);ctx.clearRect(0,0,CANVAS_W,CANVAS_H);}else if(msg.type===\"cursor\"&&msg.userId&&msg.x!=null&&msg.y!=null){setCursors(prev=>_objectSpread(_objectSpread({},prev),{},{[msg.userId]:{x:msg.x,y:msg.y,name:msg.name,tool:msg.tool}}));}// NEW: catch user_left for presence removal\nelse if(msg.type===\"user_left\"&&msg.username){setCursors(prevCursors=>{const newCursors=_objectSpread({},prevCursors);delete newCursors[msg.username];return newCursors;});}// SNAPSHOT EVENTS\nif(msg.type===\"snapshots_history\"){setSnapshots(msg.snapshots||[]);}if(msg.type===\"snapshot_restored\"){loadCanvasFromSnapshot(msg.snapshot_data);alert(\"Snapshot restored by \".concat(msg.restored_by));setShowSnapshots(false);}};const socket=wsRef.current;socket.addEventListener('message',receive);return()=>socket&&socket.removeEventListener('message',receive);},[wsRef,user,drawStroke,loadCanvasFromSnapshot]);// --- Undo handler for drawing ---\nconst handleUndo=()=>{setShapes(shapes=>{const result=shapes.slice(0,-1);const ctx=canvasRef.current.getContext('2d');ctx.clearRect(0,0,CANVAS_W,CANVAS_H);result.forEach(drawStroke);return result;});safeSendWS({type:'undo'});};// --- Mouse event handlers for drawing and interactions ---\nconst start=e=>{const{x,y}=getCanvasCoords(e);if(isConflict(x,y)){alert(\"Another user is working here! Please choose another area.\");return;}if(tool==='undo'){handleUndo();setTool('brush');return;}if(tool==='text'){const value=window.prompt(\"Enter your text:\");if(value){const ctx=canvasRef.current.getContext('2d');ctx.fillStyle=color;ctx.font='20px sans-serif';ctx.fillText(value,x,y);const textStroke={type:'text',x,y,value,color,fontSize:20};setShapes(shapes=>[...shapes,textStroke]);safeSendWS(textStroke);}return;}if(tool==='rectangle'||tool==='ellipse'){setShapeStart({x,y});setDrawing(true);return;}const ctx=canvasRef.current.getContext('2d');ctx.strokeStyle=tool==='eraser'?'#f9fafb':color;ctx.lineWidth=thickness;ctx.beginPath();ctx.moveTo(x,y);setDrawing(true);setLastPosition({x,y});};const sendCursor=useMemo(()=>debounce(coords=>{safeSendWS({type:'cursor',x:coords.x,y:coords.y,userId:user.username,name:user.firstName||user.username,tool});},24),[safeSendWS,user,tool]);const move=e=>{if(wsRef&&wsRef.current&&wsRef.current.readyState===1&&user!==null&&user!==void 0&&user.username){const coords=getCanvasCoords(e);sendCursor(coords);}if(!drawing)return;if(tool==='rectangle'||tool==='ellipse')return;const{x,y}=getCanvasCoords(e);const ctx=canvasRef.current.getContext('2d');const drawColor=tool==='eraser'?'#f9fafb':color;ctx.strokeStyle=drawColor;ctx.lineWidth=thickness;ctx.lineTo(x,y);ctx.stroke();if(lastPosition.x!==null){const payload={type:tool,fromX:lastPosition.x,fromY:lastPosition.y,toX:x,toY:y,color:drawColor,thickness};safeSendWS(payload);setShapes(shapes=>[...shapes,payload]);}setLastPosition({x,y});};const stop=e=>{setDrawing(false);setLastPosition({x:null,y:null});if(tool==='rectangle'||tool==='ellipse'){if(!shapeStart)return;const{x,y}=getCanvasCoords(e);const newShape={type:tool,fromX:shapeStart.x,fromY:shapeStart.y,toX:x,toY:y,color,thickness};setShapes(shapes=>[...shapes,newShape]);safeSendWS(newShape);const ctx=canvasRef.current.getContext('2d');if(tool==='rectangle'){ctx.strokeStyle=color;ctx.lineWidth=thickness;ctx.strokeRect(shapeStart.x,shapeStart.y,x-shapeStart.x,y-shapeStart.y);}else if(tool==='ellipse'){ctx.strokeStyle=color;ctx.lineWidth=thickness;ctx.beginPath();ctx.ellipse((shapeStart.x+x)/2,(shapeStart.y+y)/2,Math.abs((x-shapeStart.x)/2),Math.abs((y-shapeStart.y)/2),0,0,2*Math.PI);ctx.stroke();}setShapeStart(null);}};const renderOtherCursors=()=>Object.entries(cursors).map(_ref4=>{let[id,c]=_ref4;return id!==(user===null||user===void 0?void 0:user.username)&&c.x!=null&&c.y!=null?/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',left:c.x,top:c.y,pointerEvents:'none',zIndex:10,transform:'translate(-40%, -70%)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'#fff',border:'1px solid #bbb',borderRadius:8,padding:'2px 7px',fontSize:13,color:'#2d3748',boxShadow:'0 0 10px #bbb5'},children:[c.name||'User',/*#__PURE__*/_jsx(\"span\",{style:{color:'#3182ce'},children:c.tool?\" (\".concat(c.tool,\")\"):''})]}),/*#__PURE__*/_jsx(\"div\",{style:{width:14,height:14,background:'#3182ce',borderRadius:'50%',margin:'0 auto'}})]},id):null;});const queueStatus=getQueueStatus?getQueueStatus():{size:0,isEmpty:true};const statusColor=wsStatus==='connected'?'limegreen':wsStatus==='reconnecting'?'orange':wsStatus==='connecting'?'gold':wsStatus==='error'?'red':'#888';return/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%',display:'flex',flexDirection:'column',alignItems:'center',gap:18},children:[renderActiveUsersBar(),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:8,fontWeight:'bold',color:statusColor,fontSize:15},children:[\"Connection: \",wsStatus==='reconnecting'?'Reconnecting...':wsStatus==='no_auth'?'Not Authenticated':wsStatus.charAt(0).toUpperCase()+wsStatus.slice(1),queueStatus&&queueStatus.size>0&&/*#__PURE__*/_jsxs(\"span\",{style:{marginLeft:8,fontSize:13,color:'#666'},children:[\"(\",queueStatus.size,\" message\",queueStatus.size!==1?'s':'',\" queued)\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"canvas-title\",children:[\"Room: \",roomId,/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:18,color:\"#aaa\",fontSize:16},children:adminUsername&&\"(Admin: \".concat(adminUsername,\")\")})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"canvas-toolbar\",children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:14},children:\"Tool\"}),/*#__PURE__*/_jsx(\"select\",{value:tool,style:{marginLeft:8,padding:'3px 7px',borderRadius:8,border:'1px solid #bbb',fontSize:14},onChange:e=>setTool(e.target.value),children:TOOLS.map(t=>/*#__PURE__*/_jsx(\"option\",{value:t.key,children:t.label},t.key))}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:14,marginLeft:8},children:\"Color\"}),COLORS.map(c=>/*#__PURE__*/_jsx(\"button\",{className:'canvas-btn-color'+(color===c?' selected':''),style:{background:c},onClick:()=>{setColor(c);setTool('brush');}},c)),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:14,marginLeft:8},children:\"Line\"}),/*#__PURE__*/_jsx(\"select\",{value:thickness,style:{marginLeft:8,padding:'3px 7px',borderRadius:8,border:'1px solid #bbb',fontSize:14},onChange:e=>setThickness(Number(e.target.value)),children:THICKNESS.map(t=>/*#__PURE__*/_jsxs(\"option\",{value:t,children:[t,\"px\"]},t))}),/*#__PURE__*/_jsx(\"button\",{className:\"canvas-clearscreen-btn\",style:{marginLeft:12,padding:'8px 14px',borderRadius:8,background:'#e53e3e',color:'#fff',fontWeight:600,border:'none',cursor:'pointer'},onClick:()=>{safeSendWS({type:'clear'});const ctx=canvasRef.current.getContext('2d');ctx.clearRect(0,0,CANVAS_W,CANVAS_H);setShapes([]);},children:\"Clear Screen\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleSaveSnapshot,disabled:savingSnapshot,style:{margin:'0 8px',borderRadius:6,opacity:savingSnapshot?0.6:1},children:[\"\\uD83D\\uDCBE \",savingSnapshot?\"Saving...\":\"Save Snapshot\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleShowSnapshotHistory,style:{borderRadius:6},children:\"\\uD83D\\uDD52 Show Snapshot History\"}),onSwitchRoom&&/*#__PURE__*/_jsx(\"button\",{className:\"canvas-switchroom-btn\",style:{marginLeft:12,padding:'8px 14px',borderRadius:8,background:'#3182ce',color:'#fff',fontWeight:600,border:'none',cursor:'pointer'},onClick:onSwitchRoom,children:\"Switch Room\"}),(user===null||user===void 0?void 0:user.username)===adminUsername&&/*#__PURE__*/_jsx(\"button\",{className:\"canvas-deleteroom-btn\",style:{marginLeft:12,padding:'8px 14px',borderRadius:8,background:'#b60000',color:'#fff',fontWeight:600,border:'none',cursor:'pointer'},onClick:()=>{safeSendWS({type:\"delete_room\"});},children:\"Delete Room\"})]}),showSnapshots&&/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid #3182ce',padding:14,margin:10,background:'#f7fafd',borderRadius:8,width:375},children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Canvas Version History\"}),/*#__PURE__*/_jsx(\"ul\",{style:{listStyle:\"none\",padding:0},children:snapshots.map(snap=>/*#__PURE__*/_jsxs(\"li\",{style:{marginBottom:10},children:[/*#__PURE__*/_jsx(\"b\",{children:snap.saved_by}),\" at \",/*#__PURE__*/_jsx(\"span\",{style:{color:\"#3182ce\"},children:new Date(snap.created_at).toLocaleString()}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleRestoreSnapshot(snap.id),style:{marginLeft:10,borderRadius:4,background:\"#3182ce\",color:\"#fff\",padding:\"4px 12px\"},children:\"Restore\"})]},snap.id))}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowSnapshots(false),style:{background:\"#aaa\",color:\"#fff\",borderRadius:5,padding:\"2px 12px\"},children:\"Close\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative',width:CANVAS_W,height:CANVAS_H},children:[/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,className:\"canvas-canvas-area\",width:CANVAS_W,height:CANVAS_H,style:{cursor:CURSORS[tool]||'crosshair'},onMouseDown:start,onMouseMove:move,onMouseUp:stop,onMouseLeave:stop}),renderUserClaims(),renderOtherCursors()]})]});};export default Canvas;","map":{"version":3,"names":["React","useRef","useEffect","useState","useContext","useCallback","useMemo","WebSocketContext","jsx","_jsx","jsxs","_jsxs","COLORS","THICKNESS","TOOLS","key","label","CURSORS","brush","eraser","rectangle","ellipse","text","undo","CANVAS_W","CANVAS_H","debounce","fn","ms","arguments","length","undefined","timeout","_len","args","Array","_key","clearTimeout","setTimeout","Canvas","_ref","user","roomId","adminUsername","onSwitchRoom","canvasRef","drawing","setDrawing","lastPosition","setLastPosition","x","y","color","setColor","thickness","setThickness","tool","setTool","shapes","setShapes","shapeStart","setShapeStart","cursors","setCursors","snapshots","setSnapshots","showSnapshots","setShowSnapshots","savingSnapshot","setSavingSnapshot","wsRef","wsStatus","sendMessage","getQueueStatus","username","canvas","current","rect","getBoundingClientRect","Math","round","width","height","type","userId","name","firstName","safeSendWS","obj","console","warn","getCanvasCoords","e","clientX","left","clientY","top","drawStroke","stroke","_canvasRef$current","ctx","getContext","includes","beginPath","moveTo","fromX","fromY","lineTo","toX","toY","strokeStyle","lineWidth","strokeRect","abs","PI","fillStyle","font","concat","fontSize","fillText","value","exportCanvasStateJSON","JSON","stringify","loadCanvasFromSnapshot","snapshotJSON","_canvasRef$current2","snap","parse","clearRect","forEach","handleSaveSnapshot","snapshot","handleShowSnapshotHistory","handleRestoreSnapshot","snapshotId","snapshot_id","getActiveUsers","Object","entries","filter","_ref2","id","map","_ref3","c","renderActiveUsersBar","className","children","u","style","renderUserClaims","position","pointerEvents","zIndex","borderRadius","background","border","isConflict","some","lineCap","receive","event","msg","data","isArray","history","result","slice","prev","_objectSpread","prevCursors","newCursors","snapshot_data","alert","restored_by","socket","addEventListener","removeEventListener","handleUndo","start","window","prompt","textStroke","sendCursor","coords","move","readyState","drawColor","payload","stop","newShape","renderOtherCursors","_ref4","transform","padding","boxShadow","margin","queueStatus","size","isEmpty","statusColor","display","flexDirection","alignItems","gap","marginBottom","fontWeight","charAt","toUpperCase","marginLeft","onChange","target","t","onClick","Number","cursor","disabled","opacity","listStyle","saved_by","Date","created_at","toLocaleString","ref","onMouseDown","onMouseMove","onMouseUp","onMouseLeave"],"sources":["D:/REACT/collaborative-drawing-app/frontend/src/components/Canvas.js"],"sourcesContent":["import React, { useRef, useEffect, useState, useContext, useCallback, useMemo } from 'react';\r\nimport { WebSocketContext } from '../context/WebSocketContext';\r\nimport './Canvas.css';\r\n\r\n// --- Configuration Constants ---\r\nconst COLORS = ['#e53e3e', '#3182ce', '#38a169', '#f6ad55', '#2d3748', '#555'];\r\nconst THICKNESS = [2, 4, 6, 8, 12];\r\nconst TOOLS = [\r\n  { key: 'brush', label: 'Brush' },\r\n  { key: 'eraser', label: 'Eraser' },\r\n  { key: 'rectangle', label: 'Rectangle' },\r\n  { key: 'ellipse', label: 'Ellipse' },\r\n  { key: 'text', label: 'Text' },\r\n  { key: 'undo', label: 'Undo' }\r\n];\r\nconst CURSORS = {\r\n  brush: \"url(\\\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32'><circle cx='16' cy='16' r='8' fill='white' stroke='blue' stroke-width='3'/></svg>\\\") 16 16, crosshair\",\r\n  eraser: \"url(\\\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32'><rect x='7' y='10' width='18' height='8' rx='4' fill='pink' stroke='gray' stroke-width='2'/></svg>\\\") 16 14, pointer\",\r\n  rectangle: \"url(\\\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32'><rect x='8' y='8' width='16' height='10' stroke='red' fill='white' stroke-width='3'/></svg>\\\") 16 16, crosshair\",\r\n  ellipse: \"url(\\\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32'><ellipse cx='16' cy='16' rx='8' ry='5' stroke='green' fill='white' stroke-width='3'/></svg>\\\") 16 16, crosshair\",\r\n  text: \"url(\\\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32'><text x='4' y='22' font-size='18' font-family='Arial' fill='black'>T</text></svg>\\\") 6 22, text\",\r\n  undo: \"crosshair\"\r\n};\r\nconst CANVAS_W = 1200;\r\nconst CANVAS_H = 700;\r\n\r\n// --- Utility Function: Debounce ---\r\nfunction debounce(fn, ms = 12) {\r\n  let timeout;\r\n  return (...args) => {\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(() => fn(...args), ms);\r\n  };\r\n}\r\n\r\n// --- Main Canvas Component ---\r\nconst Canvas = ({ user, roomId, adminUsername, onSwitchRoom }) => {\r\n  // --- Local State and Context ---\r\n  const canvasRef = useRef(null);\r\n  const [drawing, setDrawing] = useState(false);\r\n  const [lastPosition, setLastPosition] = useState({ x: null, y: null });\r\n  const [color, setColor] = useState(COLORS[1]);\r\n  const [thickness, setThickness] = useState(4);\r\n  const [tool, setTool] = useState('brush');\r\n  const [shapes, setShapes] = useState([]);\r\n  const [shapeStart, setShapeStart] = useState(null);\r\n  const [cursors, setCursors] = useState({});\r\n  const [snapshots, setSnapshots] = useState([]);\r\n  const [showSnapshots, setShowSnapshots] = useState(false);\r\n  const [savingSnapshot, setSavingSnapshot] = useState(false);\r\n  const { wsRef, wsStatus, sendMessage, getQueueStatus } = useContext(WebSocketContext);\r\n  const username = user?.username;\r\n\r\n  // --- Helper: Clear cursors on room change & send a local event ---\r\n  useEffect(() => {\r\n    setCursors({});\r\n    const canvas = canvasRef.current;\r\n    if (!canvas || !user?.username || !sendMessage) return;\r\n    const rect = canvas.getBoundingClientRect();\r\n    const x = Math.round(rect.width / 2);\r\n    const y = Math.round(rect.height / 2);\r\n    sendMessage({\r\n      type: 'cursor',\r\n      x,\r\n      y,\r\n      userId: user.username,\r\n      name: user.firstName || user.username,\r\n      tool\r\n    });\r\n  }, [roomId, user, sendMessage, tool]);\r\n\r\n  // --- Safe wrapper for sending WebSocket messages ---\r\n  const safeSendWS = useCallback((obj) => {\r\n    if (sendMessage) {\r\n      sendMessage(obj);\r\n    } else {\r\n      console.warn('sendMessage not available from context');\r\n    }\r\n  }, [sendMessage]);\r\n\r\n  // --- Canvas coordinates relative to element size ---\r\n  const getCanvasCoords = (e) => {\r\n    const rect = canvasRef.current.getBoundingClientRect();\r\n    return {\r\n      x: Math.round(((e.clientX - rect.left) / rect.width) * CANVAS_W),\r\n      y: Math.round(((e.clientY - rect.top) / rect.height) * CANVAS_H)\r\n    };\r\n  };\r\n\r\n  // --- Drawing logic for all supported shapes ---\r\n  const drawStroke = useCallback((stroke) => {\r\n    const ctx = canvasRef.current?.getContext('2d');\r\n    if (!ctx) return;\r\n    if (['draw', 'brush', 'eraser'].includes(stroke.type)) {\r\n      ctx.beginPath();\r\n      ctx.moveTo(stroke.fromX, stroke.fromY);\r\n      ctx.lineTo(stroke.toX, stroke.toY);\r\n      ctx.strokeStyle = stroke.color;\r\n      ctx.lineWidth = stroke.thickness;\r\n      ctx.stroke();\r\n    }\r\n    if (stroke.type === 'rectangle') {\r\n      ctx.strokeStyle = stroke.color;\r\n      ctx.lineWidth = stroke.thickness;\r\n      ctx.strokeRect(\r\n        stroke.fromX, stroke.fromY,\r\n        stroke.toX - stroke.fromX, stroke.toY - stroke.fromY\r\n      );\r\n    }\r\n    if (stroke.type === 'ellipse') {\r\n      ctx.strokeStyle = stroke.color;\r\n      ctx.lineWidth = stroke.thickness;\r\n      ctx.beginPath();\r\n      ctx.ellipse(\r\n        (stroke.fromX + stroke.toX) / 2,\r\n        (stroke.fromY + stroke.toY) / 2,\r\n        Math.abs((stroke.toX - stroke.fromX) / 2),\r\n        Math.abs((stroke.toY - stroke.fromY) / 2),\r\n        0, 0, 2 * Math.PI\r\n      );\r\n      ctx.stroke();\r\n    }\r\n    if (stroke.type === 'text') {\r\n      ctx.fillStyle = stroke.color;\r\n      ctx.font = `${stroke.fontSize || 20}px sans-serif`;\r\n      ctx.fillText(stroke.value, stroke.x, stroke.y);\r\n    }\r\n  }, []);\r\n\r\n  // --- Snapshot logic for exporting/loading canvas state ---\r\n  const exportCanvasStateJSON = () => JSON.stringify(shapes);\r\n  const loadCanvasFromSnapshot = useCallback((snapshotJSON) => {\r\n    const snap = JSON.parse(snapshotJSON);\r\n    setShapes(snap);\r\n    const ctx = canvasRef.current?.getContext('2d');\r\n    if (ctx) {\r\n      ctx.clearRect(0, 0, CANVAS_W, CANVAS_H);\r\n      snap.forEach(drawStroke);\r\n    }\r\n  }, [drawStroke]);\r\n\r\n  // --- Handlers for saving and restoring snapshots ---\r\n  const handleSaveSnapshot = () => {\r\n    if (savingSnapshot) return;\r\n    setSavingSnapshot(true);\r\n    safeSendWS({\r\n      type: 'save_snapshot',\r\n      snapshot: exportCanvasStateJSON(),\r\n      username\r\n    });\r\n    setTimeout(() => setSavingSnapshot(false), 1000);\r\n  };\r\n\r\n  const handleShowSnapshotHistory = () => {\r\n    safeSendWS({ type: 'get_snapshots' });\r\n    setShowSnapshots(true);\r\n  };\r\n\r\n  const handleRestoreSnapshot = (snapshotId) => {\r\n    safeSendWS({\r\n      type: 'restore_snapshot',\r\n      snapshot_id: snapshotId,\r\n      username\r\n    });\r\n  };\r\n\r\n  // --- Presence helpers and UI for active users ---\r\n  const getActiveUsers = () => Object.entries(cursors)\r\n    .filter(([id]) => id !== user?.username)\r\n    .map(([id, c]) => ({ id, name: c.name, tool: c.tool, x: c.x, y: c.y }));\r\n\r\n  const renderActiveUsersBar = () => (\r\n    <div className=\"canvas-usersbar\">\r\n      <span className=\"canvas-usersbar-title\">Active Participants:</span>\r\n      <span className=\"canvas-usersbar-user\">{user?.firstName || user?.username} (You)</span>\r\n      {getActiveUsers().map(u =>\r\n        <span key={u.id} className=\"canvas-usersbar-user\">\r\n          {u.name} {u.tool ? <span style={{ fontSize: 13, color: '#3182ce' }}>({u.tool})</span> : null}\r\n        </span>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  const renderUserClaims = () => {\r\n    return getActiveUsers().map(u =>\r\n      (u.x != null && u.y != null) ? (\r\n        <div\r\n          key={u.id + \"-zone\"}\r\n          style={{\r\n            position: 'absolute', left: u.x - 24, top: u.y - 24,\r\n            pointerEvents: 'none', zIndex: 9, width: 48, height: 48, borderRadius: '50%',\r\n            background: 'rgba(226,38,77, 0.16)', border: '2px solid #e53e3e'\r\n          }}\r\n        />\r\n      ) : null\r\n    );\r\n  };\r\n\r\n  // --- Conflict detection for real-time coordination ---\r\n  const isConflict = (x, y) => {\r\n    return getActiveUsers().some(u =>\r\n      u.x && u.y && Math.abs(u.x - x) < 45 && Math.abs(u.y - y) < 45\r\n    );\r\n  };\r\n\r\n  // --- Effect: Setup websocket for drawing/undo/cursor/messages ---\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas || !wsRef || !wsRef.current) return;\r\n    canvas.width = CANVAS_W;\r\n    canvas.height = CANVAS_H;\r\n    const ctx = canvas.getContext('2d');\r\n    ctx.lineCap = 'round';\r\n\r\n    // Websocket receive event for this canvas\r\n    const receive = event => {\r\n      const msg = JSON.parse(event.data);\r\n      if (msg.type === \"init\" && Array.isArray(msg.history)) {\r\n        msg.history.forEach(drawStroke);\r\n      } else if (\r\n        ['draw', 'brush', 'eraser', 'rectangle', 'ellipse', 'text'].includes(msg.type)\r\n      ) {\r\n        drawStroke(msg);\r\n        setShapes(shapes => [...shapes, msg]);\r\n      } else if (msg.type === \"undo\") {\r\n        setShapes(shapes => {\r\n          const result = shapes.slice(0, -1);\r\n          ctx.clearRect(0, 0, CANVAS_W, CANVAS_H);\r\n          result.forEach(drawStroke);\r\n          return result;\r\n        });\r\n      }\r\n      else if (msg.type === \"clear\") {\r\n        setShapes([]);\r\n        ctx.clearRect(0, 0, CANVAS_W, CANVAS_H);\r\n      }\r\n      else if (msg.type === \"cursor\" && msg.userId && msg.x != null && msg.y != null) {\r\n        setCursors(prev => ({\r\n          ...prev,\r\n          [msg.userId]: { x: msg.x, y: msg.y, name: msg.name, tool: msg.tool }\r\n        }));\r\n      } \r\n      // NEW: catch user_left for presence removal\r\n      else if (msg.type === \"user_left\" && msg.username) {\r\n        setCursors(prevCursors => {\r\n          const newCursors = { ...prevCursors };\r\n          delete newCursors[msg.username];\r\n          return newCursors;\r\n        });\r\n      }\r\n      // SNAPSHOT EVENTS\r\n      if (msg.type === \"snapshots_history\") {\r\n        setSnapshots(msg.snapshots || []);\r\n      }\r\n      if (msg.type === \"snapshot_restored\") {\r\n        loadCanvasFromSnapshot(msg.snapshot_data);\r\n        alert(`Snapshot restored by ${msg.restored_by}`);\r\n        setShowSnapshots(false);\r\n      }\r\n    };\r\n\r\n    const socket = wsRef.current;\r\n    socket.addEventListener('message', receive);\r\n    return () => socket && socket.removeEventListener('message', receive);\r\n  }, [wsRef, user, drawStroke, loadCanvasFromSnapshot]);\r\n\r\n  // --- Undo handler for drawing ---\r\n  const handleUndo = () => {\r\n    setShapes(shapes => {\r\n      const result = shapes.slice(0, -1);\r\n      const ctx = canvasRef.current.getContext('2d');\r\n      ctx.clearRect(0, 0, CANVAS_W, CANVAS_H);\r\n      result.forEach(drawStroke);\r\n      return result;\r\n    });\r\n    safeSendWS({ type: 'undo' });\r\n  };\r\n\r\n  // --- Mouse event handlers for drawing and interactions ---\r\n  const start = e => {\r\n    const { x, y } = getCanvasCoords(e);\r\n    if (isConflict(x, y)) {\r\n      alert(\"Another user is working here! Please choose another area.\");\r\n      return;\r\n    }\r\n    if (tool === 'undo') {\r\n      handleUndo();\r\n      setTool('brush');\r\n      return;\r\n    }\r\n    if (tool === 'text') {\r\n      const value = window.prompt(\"Enter your text:\");\r\n      if (value) {\r\n        const ctx = canvasRef.current.getContext('2d');\r\n        ctx.fillStyle = color;\r\n        ctx.font = '20px sans-serif';\r\n        ctx.fillText(value, x, y);\r\n        const textStroke = { type: 'text', x, y, value, color, fontSize: 20 };\r\n        setShapes(shapes => [...shapes, textStroke]);\r\n        safeSendWS(textStroke);\r\n      }\r\n      return;\r\n    }\r\n    if (tool === 'rectangle' || tool === 'ellipse') {\r\n      setShapeStart({ x, y });\r\n      setDrawing(true);\r\n      return;\r\n    }\r\n    const ctx = canvasRef.current.getContext('2d');\r\n    ctx.strokeStyle = tool === 'eraser' ? '#f9fafb' : color;\r\n    ctx.lineWidth = thickness;\r\n    ctx.beginPath();\r\n    ctx.moveTo(x, y);\r\n    setDrawing(true);\r\n    setLastPosition({ x, y });\r\n  };\r\n\r\n  const sendCursor = useMemo(\r\n    () =>\r\n      debounce(coords => {\r\n        safeSendWS({\r\n          type: 'cursor',\r\n          x: coords.x,\r\n          y: coords.y,\r\n          userId: user.username,\r\n          name: user.firstName || user.username,\r\n          tool\r\n        });\r\n      }, 24),\r\n    [safeSendWS, user, tool]\r\n  );\r\n\r\n  const move = e => {\r\n    if (wsRef && wsRef.current && wsRef.current.readyState === 1 && user?.username) {\r\n      const coords = getCanvasCoords(e);\r\n      sendCursor(coords);\r\n    }\r\n    if (!drawing) return;\r\n    if (tool === 'rectangle' || tool === 'ellipse') return;\r\n    const { x, y } = getCanvasCoords(e);\r\n    const ctx = canvasRef.current.getContext('2d');\r\n    const drawColor = tool === 'eraser' ? '#f9fafb' : color;\r\n    ctx.strokeStyle = drawColor;\r\n    ctx.lineWidth = thickness;\r\n    ctx.lineTo(x, y);\r\n    ctx.stroke();\r\n    if (lastPosition.x !== null) {\r\n      const payload = {\r\n        type: tool,\r\n        fromX: lastPosition.x,\r\n        fromY: lastPosition.y,\r\n        toX: x,\r\n        toY: y,\r\n        color: drawColor,\r\n        thickness\r\n      };\r\n      safeSendWS(payload);\r\n      setShapes(shapes => [...shapes, payload]);\r\n    }\r\n    setLastPosition({ x, y });\r\n  };\r\n\r\n  const stop = e => {\r\n    setDrawing(false);\r\n    setLastPosition({ x: null, y: null });\r\n    if (tool === 'rectangle' || tool === 'ellipse') {\r\n      if (!shapeStart) return;\r\n      const { x, y } = getCanvasCoords(e);\r\n      const newShape = {\r\n        type: tool,\r\n        fromX: shapeStart.x,\r\n        fromY: shapeStart.y,\r\n        toX: x,\r\n        toY: y,\r\n        color,\r\n        thickness\r\n      };\r\n      setShapes(shapes => [...shapes, newShape]);\r\n      safeSendWS(newShape);\r\n      const ctx = canvasRef.current.getContext('2d');\r\n      if (tool === 'rectangle') {\r\n        ctx.strokeStyle = color;\r\n        ctx.lineWidth = thickness;\r\n        ctx.strokeRect(shapeStart.x, shapeStart.y, x - shapeStart.x, y - shapeStart.y);\r\n      } else if (tool === 'ellipse') {\r\n        ctx.strokeStyle = color;\r\n        ctx.lineWidth = thickness;\r\n        ctx.beginPath();\r\n        ctx.ellipse(\r\n          (shapeStart.x + x) / 2, (shapeStart.y + y) / 2,\r\n          Math.abs((x - shapeStart.x) / 2), Math.abs((y - shapeStart.y) / 2),\r\n          0, 0, 2 * Math.PI\r\n        );\r\n        ctx.stroke();\r\n      }\r\n      setShapeStart(null);\r\n    }\r\n  };\r\n\r\n  const renderOtherCursors = () =>\r\n    Object.entries(cursors).map(([id, c]) =>\r\n      id !== user?.username && c.x != null && c.y != null ? (\r\n        <div\r\n          key={id}\r\n          style={{\r\n            position: 'absolute',\r\n            left: c.x,\r\n            top: c.y,\r\n            pointerEvents: 'none',\r\n            zIndex: 10,\r\n            transform: 'translate(-40%, -70%)'\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              background: '#fff',\r\n              border: '1px solid #bbb',\r\n              borderRadius: 8,\r\n              padding: '2px 7px',\r\n              fontSize: 13,\r\n              color: '#2d3748',\r\n              boxShadow: '0 0 10px #bbb5'\r\n            }}\r\n          >\r\n            {c.name || 'User'}<span style={{ color: '#3182ce' }}>{c.tool ? ` (${c.tool})` : ''}</span>\r\n          </div>\r\n          <div\r\n            style={{\r\n              width: 14,\r\n              height: 14,\r\n              background: '#3182ce',\r\n              borderRadius: '50%',\r\n              margin: '0 auto'\r\n            }}\r\n          />\r\n        </div>\r\n      ) : null\r\n    );\r\n\r\n  const queueStatus = getQueueStatus ? getQueueStatus() : { size: 0, isEmpty: true };\r\n  const statusColor = wsStatus === 'connected' ? 'limegreen' :\r\n                      wsStatus === 'reconnecting' ? 'orange' :\r\n                      wsStatus === 'connecting' ? 'gold' :\r\n                      wsStatus === 'error' ? 'red' : '#888';\r\n\r\n  return (\r\n    <div style={{ width: '100%', display: 'flex', flexDirection: 'column', alignItems: 'center', gap: 18 }}>\r\n      {renderActiveUsersBar()}\r\n      <div style={{\r\n        marginBottom: 8,\r\n        fontWeight: 'bold',\r\n        color: statusColor,\r\n        fontSize: 15\r\n      }}>\r\n        Connection: {wsStatus === 'reconnecting' ? 'Reconnecting...' :\r\n                      wsStatus === 'no_auth' ? 'Not Authenticated' :\r\n                      wsStatus.charAt(0).toUpperCase() + wsStatus.slice(1)}\r\n        {queueStatus && queueStatus.size > 0 &&\r\n          <span style={{ marginLeft: 8, fontSize: 13, color: '#666' }}>\r\n            ({queueStatus.size} message{queueStatus.size !== 1 ? 's' : ''} queued)\r\n          </span>\r\n        }\r\n      </div>\r\n      <div className=\"canvas-title\">\r\n        Room: {roomId}\r\n        <span style={{ marginLeft: 18, color: \"#aaa\", fontSize: 16 }}>\r\n          {adminUsername && `(Admin: ${adminUsername})`}\r\n        </span>\r\n      </div>\r\n\r\n      {/* Toolbar */}\r\n      <div className=\"canvas-toolbar\">\r\n        <span style={{ fontSize: 14 }}>Tool</span>\r\n        <select\r\n          value={tool}\r\n          style={{ marginLeft: 8, padding: '3px 7px', borderRadius: 8, border: '1px solid #bbb', fontSize: 14 }}\r\n          onChange={e => setTool(e.target.value)}\r\n        >\r\n          {TOOLS.map(t => (\r\n            <option key={t.key} value={t.key}>{t.label}</option>\r\n          ))}\r\n        </select>\r\n        <span style={{ fontSize: 14, marginLeft: 8 }}>Color</span>\r\n        {COLORS.map(c =>\r\n          <button\r\n            key={c}\r\n            className={'canvas-btn-color' + (color === c ? ' selected' : '')}\r\n            style={{ background: c }}\r\n            onClick={() => { setColor(c); setTool('brush'); }}\r\n          />\r\n        )}\r\n        <span style={{ fontSize: 14, marginLeft: 8 }}>Line</span>\r\n        <select\r\n          value={thickness}\r\n          style={{ marginLeft: 8, padding: '3px 7px', borderRadius: 8, border: '1px solid #bbb', fontSize: 14 }}\r\n          onChange={e => setThickness(Number(e.target.value))}\r\n        >\r\n          {THICKNESS.map(t =>\r\n            <option key={t} value={t}>{t}px</option>\r\n          )}\r\n        </select>\r\n        <button\r\n          className=\"canvas-clearscreen-btn\"\r\n          style={{\r\n            marginLeft: 12,\r\n            padding: '8px 14px',\r\n            borderRadius: 8,\r\n            background: '#e53e3e',\r\n            color: '#fff',\r\n            fontWeight: 600,\r\n            border: 'none',\r\n            cursor: 'pointer'\r\n          }}\r\n          onClick={() => {\r\n            safeSendWS({ type: 'clear' });\r\n            const ctx = canvasRef.current.getContext('2d');\r\n            ctx.clearRect(0, 0, CANVAS_W, CANVAS_H);\r\n            setShapes([]);\r\n          }}\r\n        >Clear Screen</button>\r\n        <button onClick={handleSaveSnapshot} disabled={savingSnapshot} style={{ margin: '0 8px', borderRadius: 6, opacity: savingSnapshot ? 0.6 : 1 }}>\r\n          ðŸ’¾ {savingSnapshot ? \"Saving...\" : \"Save Snapshot\"}\r\n        </button>\r\n        <button onClick={handleShowSnapshotHistory} style={{ borderRadius: 6 }}>\r\n          ðŸ•’ Show Snapshot History\r\n        </button>\r\n        {onSwitchRoom &&\r\n          <button\r\n            className=\"canvas-switchroom-btn\"\r\n            style={{\r\n              marginLeft: 12,\r\n              padding: '8px 14px',\r\n              borderRadius: 8,\r\n              background: '#3182ce',\r\n              color: '#fff',\r\n              fontWeight: 600,\r\n              border: 'none',\r\n              cursor: 'pointer'\r\n            }}\r\n            onClick={onSwitchRoom}\r\n          >Switch Room</button>\r\n        }\r\n        {user?.username === adminUsername && (\r\n          <button\r\n            className=\"canvas-deleteroom-btn\"\r\n            style={{\r\n              marginLeft: 12,\r\n              padding: '8px 14px',\r\n              borderRadius: 8,\r\n              background: '#b60000',\r\n              color: '#fff',\r\n              fontWeight: 600,\r\n              border: 'none',\r\n              cursor: 'pointer'\r\n            }}\r\n            onClick={() => {\r\n              safeSendWS({ type: \"delete_room\" });\r\n            }}\r\n          >Delete Room</button>\r\n        )}\r\n      </div>\r\n      {showSnapshots && (\r\n        <div style={{\r\n          border: '1px solid #3182ce', padding: 14, margin: 10, background: '#f7fafd', borderRadius: 8, width: 375\r\n        }}>\r\n          <h4>Canvas Version History</h4>\r\n          <ul style={{ listStyle: \"none\", padding: 0 }}>\r\n            {snapshots.map((snap) => (\r\n              <li key={snap.id} style={{ marginBottom: 10 }}>\r\n                <b>{snap.saved_by}</b> at <span style={{ color: \"#3182ce\" }}>{new Date(snap.created_at).toLocaleString()}</span>\r\n                <button onClick={() => handleRestoreSnapshot(snap.id)} style={{\r\n                  marginLeft: 10, borderRadius: 4, background: \"#3182ce\", color: \"#fff\", padding: \"4px 12px\"\r\n                }}>\r\n                  Restore\r\n                </button>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n          <button onClick={() => setShowSnapshots(false)} style={{\r\n            background: \"#aaa\", color: \"#fff\", borderRadius: 5, padding: \"2px 12px\"\r\n          }}>Close</button>\r\n        </div>\r\n      )}\r\n      <div style={{ position: 'relative', width: CANVAS_W, height: CANVAS_H }}>\r\n        <canvas\r\n          ref={canvasRef}\r\n          className=\"canvas-canvas-area\"\r\n          width={CANVAS_W}\r\n          height={CANVAS_H}\r\n          style={{ cursor: CURSORS[tool] || 'crosshair' }}\r\n          onMouseDown={start}\r\n          onMouseMove={move}\r\n          onMouseUp={stop}\r\n          onMouseLeave={stop}\r\n        />\r\n        {renderUserClaims()}\r\n        {renderOtherCursors()}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Canvas;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}