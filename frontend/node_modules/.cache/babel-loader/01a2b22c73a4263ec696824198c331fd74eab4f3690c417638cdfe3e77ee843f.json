{"ast":null,"code":"var _jsxFileName = \"D:\\\\REACT\\\\collaborative-drawing-app\\\\frontend\\\\src\\\\components\\\\LiveCaptions.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useContext, useRef } from \"react\";\nimport { WebSocketContext } from \"../context/WebSocketContext\";\nimport \"./LiveCaptions.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst speechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition || null;\nexport default function LiveCaptions({\n  roomId,\n  username\n}) {\n  _s();\n  const {\n    sendMessage,\n    lastMessage\n  } = useContext(WebSocketContext);\n  const [captions, setCaptions] = useState({});\n  const recognitionRef = useRef(null);\n\n  // Start speech recognition and send live captions\n  useEffect(() => {\n    if (!speechRecognition) return;\n    const recognition = new speechRecognition();\n    recognitionRef.current = recognition;\n    recognition.continuous = true;\n    recognition.interimResults = true;\n    recognition.lang = \"en-US\";\n    let lastTranscript = \"\";\n    recognition.onresult = event => {\n      let transcript = \"\";\n      for (let i = event.resultIndex; i < event.results.length; ++i) {\n        transcript += event.results[i][0].transcript;\n      }\n      lastTranscript = transcript.trim();\n      if (lastTranscript.length > 0) {\n        setCaptions(prev => ({\n          ...prev,\n          [username]: lastTranscript\n        }));\n        sendMessage({\n          type: \"caption\",\n          roomId,\n          username,\n          transcript: lastTranscript\n        });\n      }\n    };\n    recognition.onend = () => {\n      // Auto-restart for continuous captioning\n      recognition.start();\n    };\n    recognition.start();\n    return () => {\n      recognition.onend = null;\n      recognition.stop();\n    };\n  }, [roomId, username, sendMessage]);\n\n  // Update for received \"caption\" events from other users\n  useEffect(() => {\n    if (!lastMessage) return;\n    let data;\n    try {\n      data = JSON.parse(lastMessage);\n    } catch {\n      return;\n    }\n    if (data.type === \"caption\" && data.roomId === roomId && data.username !== username && data.transcript) {\n      setCaptions(prev => ({\n        ...prev,\n        [data.username]: data.transcript\n      }));\n    }\n  }, [lastMessage, roomId, username]);\n\n  // Render a ribbon overlay with all current captions\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"live-captions-ribbon\",\n    children: Object.entries(captions).filter(([user, txt]) => !!txt).map(([user, txt]) => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"live-caption\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"live-caption-user\",\n        children: [user, \":\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"live-caption-text\",\n        children: txt\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 13\n      }, this)]\n    }, user, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 11\n    }, this))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 5\n  }, this);\n}\n_s(LiveCaptions, \"lI7NLUGb5RnYJ2kDY0zD+kW6gZ0=\");\n_c = LiveCaptions;\nvar _c;\n$RefreshReg$(_c, \"LiveCaptions\");","map":{"version":3,"names":["React","useEffect","useState","useContext","useRef","WebSocketContext","jsxDEV","_jsxDEV","speechRecognition","window","SpeechRecognition","webkitSpeechRecognition","LiveCaptions","roomId","username","_s","sendMessage","lastMessage","captions","setCaptions","recognitionRef","recognition","current","continuous","interimResults","lang","lastTranscript","onresult","event","transcript","i","resultIndex","results","length","trim","prev","type","onend","start","stop","data","JSON","parse","className","children","Object","entries","filter","user","txt","map","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/REACT/collaborative-drawing-app/frontend/src/components/LiveCaptions.js"],"sourcesContent":["import React, { useEffect, useState, useContext, useRef } from \"react\";\r\nimport { WebSocketContext } from \"../context/WebSocketContext\";\r\nimport \"./LiveCaptions.css\";\r\n\r\nconst speechRecognition =\r\n  window.SpeechRecognition || window.webkitSpeechRecognition || null;\r\n\r\nexport default function LiveCaptions({ roomId, username }) {\r\n  const { sendMessage, lastMessage } = useContext(WebSocketContext);\r\n  const [captions, setCaptions] = useState({});\r\n  const recognitionRef = useRef(null);\r\n\r\n  // Start speech recognition and send live captions\r\n  useEffect(() => {\r\n    if (!speechRecognition) return;\r\n    const recognition = new speechRecognition();\r\n    recognitionRef.current = recognition;\r\n\r\n    recognition.continuous = true;\r\n    recognition.interimResults = true;\r\n    recognition.lang = \"en-US\";\r\n\r\n    let lastTranscript = \"\";\r\n\r\n    recognition.onresult = (event) => {\r\n      let transcript = \"\";\r\n      for (let i = event.resultIndex; i < event.results.length; ++i) {\r\n        transcript += event.results[i][0].transcript;\r\n      }\r\n      lastTranscript = transcript.trim();\r\n      if (lastTranscript.length > 0) {\r\n        setCaptions((prev) => ({\r\n          ...prev,\r\n          [username]: lastTranscript,\r\n        }));\r\n        sendMessage({\r\n          type: \"caption\",\r\n          roomId,\r\n          username,\r\n          transcript: lastTranscript,\r\n        });\r\n      }\r\n    };\r\n\r\n    recognition.onend = () => {\r\n      // Auto-restart for continuous captioning\r\n      recognition.start();\r\n    };\r\n\r\n    recognition.start();\r\n    return () => {\r\n      recognition.onend = null;\r\n      recognition.stop();\r\n    };\r\n  }, [roomId, username, sendMessage]);\r\n\r\n  // Update for received \"caption\" events from other users\r\n  useEffect(() => {\r\n    if (!lastMessage) return;\r\n    let data;\r\n    try {\r\n      data = JSON.parse(lastMessage);\r\n    } catch {\r\n      return;\r\n    }\r\n    if (data.type === \"caption\" && data.roomId === roomId && data.username !== username && data.transcript) {\r\n      setCaptions((prev) => ({\r\n        ...prev,\r\n        [data.username]: data.transcript,\r\n      }));\r\n    }\r\n  }, [lastMessage, roomId, username]);\r\n\r\n  // Render a ribbon overlay with all current captions\r\n  return (\r\n    <div className=\"live-captions-ribbon\">\r\n      {Object.entries(captions)\r\n        .filter(([user, txt]) => !!txt)\r\n        .map(([user, txt]) => (\r\n          <div key={user} className=\"live-caption\">\r\n            <span className=\"live-caption-user\">{user}:</span>\r\n            <span className=\"live-caption-text\">{txt}</span>\r\n          </div>\r\n        ))}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}